# Story 2.1: Client Source HTTP Configuration

## Status
Draft

## Story
**As a** content marketing operator,
**I want** to add and manage client-specific HTTP sources with immediate validation,
**so that** the discovery agent ingests only approved feeds without engineering help.

## Acceptance Criteria
1. Source form accepts only `http://` or `https://` URLs and rejects other protocols with inline error messaging.
2. Duplicate sources (case-insensitive) are blocked and surfaced to the user before save.
3. Successful creation persists immediately and emits an SSE `source.created` event scoped to the client.
4. UI shows optimistic success state; rollback occurs if backend persistence fails (with error toast).

## Tasks / Subtasks
- [ ] Implement backend endpoint to create/delete/list client sources with validation (AC 1, AC 2).
- [ ] Add frontend form with inline validation errors and optimistic update pattern (AC 1, AC 4).
- [ ] Emit SSE event `source.created` with payload `{ id, url, clientId, createdAt }` (AC 3).
- [ ] Write integration tests covering valid/invalid URLs and duplicate submissions (AC 1, AC 2).
- [ ] Update configuration documentation/runbook for pilot onboarding (AC 4).

## Dev Notes
- Backend likely extends existing Nitro API under `server/api/clients/[id]/sources` with Drizzle models.
- Reuse shared validation utilities where possible; add server-side guards even if frontend validates.
- Ensure SSE channel uses telemetry epic schema versioning (coordinate with Story TR-1).

### Testing
- Unit tests: `pnpm test --filter sources` (add new suite under server tests).
- E2E smoke: add Playwright/Vitest UI test ensuring validation errors render correctly.

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-03-29 | 0.1 | Initial draft aligned with Epic: Client Source Configuration. | PM |

## Dev Agent Record
_Not yet worked._
