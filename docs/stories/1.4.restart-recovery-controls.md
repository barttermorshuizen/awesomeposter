# Story 1.4: Restart Recovery Controls

## Status
Draft

## Story
**As an** internal operator,
**I want** reliable controls to resume or remove in-progress runs after service restarts,
**so that** stale orchestration states can be resolved without manual cleanup.

## Acceptance Criteria
1. UI surfaces "Resume creating post" and "Remove running create post" actions with clear status messaging when a briefing has a suspended orchestration thread (e.g., after restart).
2. Resuming a run reloads the persisted orchestrator state (plan artifacts, HITL context, runner metadata) and restarts from the last completed step without duplicating prior work.
3. Removing a run clears persisted plan/HITL records, unlocks the briefing for new runs, and records the operator identity and timestamp.
4. Operators receive confirmation indicators (toast or inline status) that the stale state has been successfully resumed or removed.

## Tasks / Subtasks
- [ ] Detect suspended orchestration threads via Story 1.2 APIs/store and expose resume/remove actions in appropriate UI surfaces (AC 1).
  - [ ] Ensure actions are visible only to authorized operators and when suspended state exists, reflecting backend status codes accurately (Must-fix linkage) (AC 1).
- [ ] Implement resume action flow calling backend endpoint to rehydrate orchestrator state and trigger plan continuation (AC 2).
  - [ ] Update UI state to reflect resumed status and hide stale indicators (AC 2).
- [ ] Implement remove action flow invoking backend cancellation endpoint, clearing local state, and marking run as removed with audit metadata (AC 3).
  - [ ] Confirm backend response includes acknowledgement so UI can display confirmation (AC 3, AC 4).
- [ ] Add toasts or inline banners for success/failure of resume/remove, and provide retry guidance on errors using backend status codes/messages (AC 4).
  - [ ] Document operator instructions (e.g., help tooltip) explaining when to resume vs remove (supports AC 1-4).

## Dev Notes
- UI integration likely in create-post popup and/or orchestration management view; reuse existing status components.
- State source should reuse the persistence/resume store built in Story 1.2 to avoid duplicated fetch logic.
- Resume action must coordinate with orchestrator to prevent concurrent resumes; consider disabling controls until response arrives.
- Removal must invoke backend cancellation so no orphaned tasks remain; verify feature flag gating matches earlier stories and ensure UI messaging maps to backend status codes (Must-fix dependency).

### Testing
- Component/unit tests verifying buttons appear only when suspended state detected and trigger correct handlers (Vitest + Vue Test Utils).
- Integration test covering resume/remove flows against mocked API to ensure state updates and confirmations render, including status-code-to-UI messaging alignment.
- Manual smoke after orchestrator restart to confirm suspended runs appear and can be resumed or removed cleanly.

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-09-24 | 0.1 | Initial draft of Story 1.4 from Epic HITL-1. | PO |
