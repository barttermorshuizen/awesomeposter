# Story 4.4: Traction-Weighted Nugget Ranking

## Status
Draft

## Story
**As a** discovery product owner,
**I want** the scoring workflow to combine relevance with an external traction signal,
**so that** nugget ranking reflects real-world attention and surfaces the most valuable insights first.

## Acceptance Criteria
1. Comprehensive nugget score = relevance signal + traction signal, with weights provided via configuration.
2. Traction signal aggregates indirect sources (Google-detected LinkedIn mentions, public newsletters, RSS feed activity, YouTube channel metrics, Reddit, Twitter, duplicate frequency from Story 4.2, etc.); each source can be toggled and weighted through configuration.
3. Scoring output exposes relevance score, traction score, and combined score for downstream ranking and telemetry consumers.
4. When traction data is unavailable, ranking gracefully reverts to relevance-only scoring without breaking existing workflows.
5. Traction scoring module follows the existing story-4 signal step pattern and integrates with the shared nugget data model without altering its schema.
6. Outbound traction lookups honour configurable rate limits (time interval or requests per window) and gracefully degrade when limits are reached.
7. Unit tests cover traction aggregation, weighting, fallbacks, and rate-limiting behaviour; integration test verifies combined score path and deterministic ordering.
8. Story 4 specification/documentation updated to describe traction sourcing, configuration options, and operational limits.

## Tasks / Subtasks
- [ ] Introduce `traction-score` module mirroring the current relevance signal structure; inject configuration for weights/toggles (AC 1, AC 2, AC 5).
- [ ] Define provider interfaces for indirect data sources (Googleâ†’LinkedIn, newsletters, RSS feeds, YouTube channels, Reddit, Twitter, duplicate frequency signal) with stubs to be implemented later; ensure outputs normalize to a common traction metric (AC 2, AC 3).
- [ ] Implement configurable rate limiter for outbound traction calls (AC 6).
- [ ] Update scoring pipeline to call traction module, merge results, and expose detailed scores (AC 1, AC 3, AC 4).
- [ ] Add telemetry/logging hooks capturing traction fetch status and fallback usage (AC 3, AC 4).
- [ ] Write/update documentation for Story 4, covering traction sourcing, configuration, and rate limiting (AC 8).
- [ ] Add unit/integration tests for module weighting, fallback behaviour, rate limiting, and deterministic ranking (AC 7).

## Dev Notes
- Reuse existing configuration injection pattern in `packages/shared` to remain consistent with story-4 modules.
- External provider implementations can initially return mocked values; ensure clear TODOs for real API clients, RSS/YouTube integration, and duplicate-signal wiring.
- Rate-limiter should support both fixed-window and token-bucket style limits via configuration flag.

### Testing
- Unit: traction weighting, rate limiter threshold, fallback to relevance-only.
- Integration: pipeline run with mocked providers to verify combined score order and telemetry emission.

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-03-30 | 0.1 | Draft for Epic: Scoring & Deduplication. | PO |

## Dev Agent Record
_Not yet worked._
