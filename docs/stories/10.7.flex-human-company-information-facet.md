# Story 10.7: Flex Human Company Information Facet Display

## Status
Draft

## Story
**As a** flex marketing operator working inside the task panel,  
**I want** the `company_information` facet to render an actionable, readable layout,  
**so that** I can absorb brand guardrails quickly while delivering high-quality creative work.

**Dependencies:** Completion of Story 10.3 (flex human task surfaces). (`docs/stories/10.3.flex-human-task-surfaces.md`)

## Acceptance Criteria
1. When a human assignment includes the `company_information` facet, the flex task widget registry resolves a dedicated component that renders the company name prominently, surfaces fields in labelled sections, and integrates the widget into `FlexTaskPanel.vue` without relying on the legacy HITL panel. (`docs/architecture/flex-agents-server.md#154-facet-driven-task-surfaces`)
2. The widget displays all schema properties from the `company_information` facet, including industry, tone of voice, audience segments, and preferred channels; the company name remains easily identifiable, any available website is exposed through a world-icon link that opens in a new tab, and missing optional fields present graceful placeholders. (`docs/architecture/flex-agents-server/512-reference-facet-catalog.md#facet-company_information`)
3. `special_instructions` text is emphasized in italics, and each `brand_assets` entry renders as a thumbnail with an adjacent download icon that links to the asset URI while providing accessible labels and fallback imagery if a preview fails. (`docs/architecture/flex-agents-server/512-reference-facet-catalog.md#facet-company_information`, `docs/architecture/flex-agents-server.md#154-facet-driven-task-surfaces`)
4. Vitest coverage exercises the widget rendering (including fallback cases), validates the website icon link behaviour, and asserts that thumbnails and download controls are exposed for every asset under `npm run test:unit`. (`docs/architecture/coding-standards.md#7-testing-expectations`, `docs/architecture/flex-agents-server.md#154-facet-driven-task-surfaces`)

## Tasks / Subtasks
- [ ] Implement `CompanyInformationWidget` under `src/components/flex-tasks/widgets/` to render the formatted layout, including heading treatment, website icon link, italicized instructions, and labelled property blocks. (AC 1-3) (`docs/architecture/flex-agents-server.md#154-facet-driven-task-surfaces`, `docs/architecture/flex-agents-server/512-reference-facet-catalog.md#facet-company_information`)
- [ ] Register the widget in the facet registry and ensure the `flexTasks` store pipes `company_information` data into the component with appropriate typing and graceful handling for missing optional fields. (AC 1-2) (`docs/stories/10.3.flex-human-task-surfaces.md`, `docs/architecture/flex-agents-server.md#154-facet-driven-task-surfaces`)
- [ ] Render each `brand_assets` entry with thumbnail previews, download icons, accessible labels, and placeholder art when previews fail, logging toast feedback through existing utilities. (AC 3) (`docs/architecture/flex-agents-server/512-reference-facet-catalog.md#facet-company_information`, `docs/architecture/flex-agents-server.md#154-facet-driven-task-surfaces`)
- [ ] Add Vitest component tests that cover populated, partially populated, and empty states, verifying website link targets, thumbnail rendering, download controls, and fallback behaviour. (AC 4) (`docs/architecture/coding-standards.md#7-testing-expectations`, `docs/architecture/flex-agents-server.md#154-facet-driven-task-surfaces`)

## Story Context
- Marketing capabilities such as strategist, copywriter, designer, and director nodes all declare `company_information` as part of their input contracts, so human operators need an expressive layout summarizing the facet in the task panel. (`docs/architecture/flex-agents-server/11-capability-registry-agent-contracts.md`)
- Facet-driven task surfaces mandate that each facet owns its widget, composed by the `flexTasks` store and rendered inside `FlexTaskPanel.vue`, keeping the experience separate from legacy HITL approvals. (`docs/architecture/flex-agents-server.md#154-facet-driven-task-surfaces`)
- The facet schema enumerates company name, website, industry, tone, audience segments, preferred channels, special instructions, and brand assets, requiring the widget to respect the structure and optional fields. (`docs/architecture/flex-agents-server/512-reference-facet-catalog.md#facet-company_information`)

## Dev Notes
- **Previous Story Insights:** Story 10.3 introduced the `flexTasks` store, facet widget registry, and default fallback widgets, so the new component should reuse those patterns and avoid touching the HITL panel. (`docs/stories/10.3.flex-human-task-surfaces.md`) Story 10.6 outlined asset presentation patterns within the flex task panel, offering precedents for thumbnail handling and accessible controls. (`docs/stories/10.6.flex-human-post-visual-widget.md`)
- **Data Models:** `company_information` follows the facet schema defining required (`name`, `brand_assets`) and optional fields, ensuring the widget respects the schema and presents placeholders where optional data is absent. (`docs/architecture/flex-agents-server/512-reference-facet-catalog.md#facet-company_information`)
- **API Specifications:** Human assignments surface facet payloads via `node_start` frames and resume through `/api/v1/flex/run.resume`, so the widget must treat inputs as read-only context while leaving submission payloads untouched. (`docs/architecture/flex-agents-server.md#153-implementation-alignment`, `docs/architecture/flex-agents-server.md#155-notification-and-assignment-model`)
- **Component Specifications:** The widget plugs into the facet widget registry consumed by `FlexTaskPanel.vue`, delivering Vuetify-based layouts, reuse of toast utilities, and adherence to accessibility expectations documented for HITL panels. (`docs/architecture/flex-agents-server.md#154-facet-driven-task-surfaces`, `docs/architecture/hitl/7-front-end-state-ux-contract.md#7-front-end-state--ux-contract`)
- **File Locations:** Place the widget under `src/components/flex-tasks/widgets/`, update the registry in the same directory, and augment tests under `src/components/flex-tasks/__tests__/`. (`docs/architecture/source-tree.md#2-spa`)
- **Testing Requirements:** Add Vitest + Vue Test Utils suites that execute with `npm run test:unit`, covering populated and fallback scenarios. (`docs/architecture/coding-standards.md#7-testing-expectations`)
- **Technical Constraints:** Implement using Vue 3 Composition API with TypeScript and Vuetify components, aligning with the approved SPA stack and coding standards. (`docs/architecture/tech-stack.md#1-core-runtime-components`, `docs/architecture/coding-standards.md#1-language--module-conventions`)
- **Project Structure Notes:** No new directories are required; reuse existing flex task widget and test structure. (`docs/architecture/source-tree.md#2-spa`)

## Testing
- `npm run test:unit -- src/components/flex-tasks/__tests__/CompanyInformationWidget.spec.ts`

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-04-05 | 0.1 | Initial draft defining the company information facet widget requirements and validation scope. | Scrum Master |

## QA Results

_Not yet reviewed. QA to update this section only._
