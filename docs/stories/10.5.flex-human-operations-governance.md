# Story 10.5: Flex Human Operations & Governance Documentation

## Status
Ready for Dev

## Story
**As a** flex operations program lead,  
**I want** updated governance documentation, rollout guidance, and troubleshooting runbooks for human-operated flex nodes,  
**so that** operators and on-call engineers can safely enable the feature, meet policy guardrails, and recover deterministic runs when issues occur.

**Dependencies:** Completion of Story 10.4 (flex human notification & assignment plumbing). (`docs/stories/10.4.flex-human-notification-plumbing.md`)

## Acceptance Criteria
1. Configuration and rollout documentation details how to enable or disable human participation via feature flags and environment settings, covering staged rollout steps and fallback guidance. (`docs/architecture/hitl/8-configuration-feature-flagging.md#81-flex-task-panel-configuration`, `docs/architecture/hitl/11-rollout-strategy.md`, `docs/architecture/flex-agents-server.md#1510-registration--governance-notes`)
2. Governance notes capture policy guardrails for human assignments—`FLEX_HUMAN_ASSIGNMENT_TIMEOUT_SECONDS`, single-notification limits, and capability-aligned routing metadata—linking orchestration behaviour to operator expectations. (`docs/architecture/flex-agents-server.md#1510-registration--governance-notes`, `docs/architecture/flex-agents-server.md#155-notification-and-assignment-model`)
3. Troubleshooting runbook documents how to diagnose backlog gaps or stalled runs using SSE telemetry (`node_start/node_complete` facets), flex task APIs, and persisted snapshots for offline recovery. (`docs/architecture/flex-agents-server.md#159-offline-and-notification-semantics`, `docs/architecture/flex-agents-server.md#10-api-surface-initial`, `docs/architecture/hitl/5-key-data-flows.md#51-specialist-raises-hitl-request`)
4. Security, compliance, and audit sections reflect human-node participation: logging operator submissions, retaining rationale/assignment metadata, and reconciling risks and mitigations for SLA breaches or notification failures. (`docs/architecture/hitl/10-security-compliance.md`, `docs/architecture/hitl/12-risks-mitigations.md`, `docs/architecture/flex-agents-server.md#1510-registration--governance-notes`)

## Tasks / Subtasks
- [ ] Update configuration and rollout docs (`docs/architecture/hitl/8-configuration-feature-flagging.md`, `docs/architecture/hitl/11-rollout-strategy.md`) with flex human enablement, staged rollout plan, and rollback toggles. (AC 1) (`docs/architecture/hitl/8-configuration-feature-flagging.md#81-flex-task-panel-configuration`, `docs/architecture/hitl/11-rollout-strategy.md`)
- [ ] Extend governance notes to spell out human assignment guardrails, SLA enforcement, and capability-based routing metadata. (AC 2) (`docs/architecture/flex-agents-server.md#1510-registration--governance-notes`, `docs/architecture/flex-agents-server.md#155-notification-and-assignment-model`)
- [ ] Author troubleshooting guidance that walks operators through SSE telemetry interpretation, `/api/v1/flex/tasks` backlog checks, and resume diagnostics. (AC 3) (`docs/architecture/flex-agents-server.md#159-offline-and-notification-semantics`, `docs/architecture/flex-agents-server.md#10-api-surface-initial`)
- [ ] Refresh security/compliance and risk mitigation docs with human submission logging, audit expectations, and SLA breach handling. (AC 4) (`docs/architecture/hitl/10-security-compliance.md`, `docs/architecture/hitl/12-risks-mitigations.md`)
- [ ] Capture change summary and links to updated docs in the architecture change log or release notes if required. (AC 1-4) (`docs/architecture/flex-agents-server.md#1510-registration--governance-notes`)

## Story Context
- Notification plumbing (Story 10.4) now surfaces capability metadata and backlog APIs for human work queues; documentation must teach operators how to monitor and enable these paths. (`docs/stories/10.4.flex-human-notification-plumbing.md`)
- Feature flags (`VITE_FLEX_REQUIRE_HITL`, `ENABLE_HITL`) and SLA env vars (`FLEX_HUMAN_ASSIGNMENT_TIMEOUT_SECONDS`) govern rollout and guardrails; operations teams need consolidated instructions. (`docs/architecture/hitl/8-configuration-feature-flagging.md#81-flex-task-panel-configuration`, `docs/architecture/flex-agents-server.md#1510-registration--governance-notes`)
- Offline recovery relies on replaying `flex_plan_nodes` state and the flex task APIs to reconcile backlog gaps. (`docs/architecture/flex-agents-server.md#159-offline-and-notification-semantics`)
- Existing HITL policies remain separate; documentation must highlight boundaries between legacy approvals and capability-driven human assignments. (`docs/architecture/flex-agents-server.md#155-notification-and-assignment-model`, `docs/architecture/hitl/7-front-end-state-ux-contract.md#7-front-end-state--ux-contract`)

## Dev Notes
- **Previous Story Insights:** Story 10.4 documented capability-based routing and backlog hydration for human assignments; incorporate those details into operator guidance and rollout materials. (`docs/stories/10.4.flex-human-notification-plumbing.md`)
- **Data Models:** `flex_plan_nodes`, `flex_plan_snapshots`, and assignment metadata persist pending human work and rationale for audits; documentation should reference these stores when describing recovery flows. (`docs/architecture/flex-agents-server.md#9-data-model--persistence`)
- **API Specifications:** `/api/v1/flex/tasks`, `/api/v1/flex/tasks/:taskId/decline`, and `/api/v1/flex/run.resume` underpin backlog checks and resume workflows; include these endpoints in runbook steps. (`docs/architecture/flex-agents-server.md#10-api-surface-initial`)
- **Component Specifications:** Operator tooling observes `node_start/node_complete/node_error` SSE events with facet metadata; documentation should outline how the SPA and notification services react to these signals. (`docs/architecture/flex-agents-server.md#155-notification-and-assignment-model`, `docs/architecture/flex-agents-server.md#159-offline-and-notification-semantics`)
- **File Locations:** Architecture references live under `docs/architecture/hitl/` and `docs/architecture/flex-agents-server.md`; ensure updates align with existing structure and change log conventions. (`docs/architecture/source-tree.md#6-documentation-assets`)
- **Testing Requirements:** Run linting to validate markdown formatting consistency. (`docs/architecture/coding-standards.md#6-linting--formatting`)
- **Technical Constraints:** Maintain concise, reference-backed documentation that follows existing markdown patterns, link to specific sections, and avoid duplicating legacy HITL instructions. (`docs/architecture/coding-standards.md#6-linting--formatting`)
- **Project Structure Notes:** Documentation updates stay within the `docs/architecture` tree; no structural changes required. (`docs/architecture/source-tree.md#6-documentation-assets`)

## Testing
- `npm run lint`

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-04-03 | 0.1 | Initial draft outlining operations, governance, and troubleshooting documentation scope for human flex participation. | Scrum Master |

## QA Results

_Not yet reviewed. QA to update this section only._
