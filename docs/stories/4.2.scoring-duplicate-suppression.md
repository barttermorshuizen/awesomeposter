# Story 4.2: Duplicate Suppression

## Status
Draft

## Story
**As the** scoring pipeline,
**I want** to detect and suppress duplicate items,
**so that** reviewers are not overwhelmed by repeated nuggets.

## Acceptance Criteria
1. Duplicate detection uses URL hash plus title similarity (Jaccard or cosine) with configurable threshold, handling normalized RSS articles and YouTube videos.
2. First-seen item becomes canonical; duplicates linked via `duplicateOf` reference and hidden from brief queue.
3. Suppressed duplicates remain queryable via admin view for traceability.
4. SSE `duplicate.suppressed` emitted with canonical and duplicate IDs.

## Tasks / Subtasks
- [ ] Compute canonical hash and similarity check during scoring (AC 1).
- [ ] Update datastore schema to store `duplicateOf` relationship (AC 2).
- [ ] Adjust brief creation logic to skip suppressed items (AC 2).
- [ ] Emit SSE event with payload and ensure telemetry counts duplicates (AC 4).
- [ ] Add regression tests covering identical URL, similar title, and false-positive guard (AC 1).

## Dev Notes
- Use ASCII normalization to avoid Unicode mismatch per repo policy and strip tracking params across RSS/YouTube URLs.
- Provide manual override script to unmark duplicates if misclassified.

### Testing
- Unit: test hash + similarity thresholds.
- Integration: pipeline ensures suppressed items not surfaced to dashboard.

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-03-29 | 0.1 | Draft for Epic: Scoring & Deduplication. | PM |

## Dev Agent Record
_Not yet worked._
