# Story 2.3: Source Health Status

## Status
Draft

## Story
**As a** marketing operator,
**I want** to see the last fetch status for each configured source,
**so that** I can diagnose ingestion issues quickly and adjust sources if needed.

## Acceptance Criteria
1. Source list displays last fetch timestamp and status badge (`Success`, `Warning`, `Error`) sourced from ingestion telemetry.
2. Status `Warning` appears when last fetch occurred >24 hours ago; `Error` appears after 3 consecutive failures.
3. Hover or details panel shows last failure reason message when available.
4. Data refreshes automatically via SSE `source.health` events without manual reload.

## Tasks / Subtasks
- [ ] Extend ingestion service to publish health state updates (success/failure streaks) to telemetry store (AC 1, AC 2).
- [ ] Create SSE event type `source.health` delivering `{ clientId, sourceId, status, lastFetchedAt, failureReason }` (AC 4).
- [ ] Update UI list component to render status badges and tooltips (AC 1, AC 3).
- [ ] Add scheduled job to mark stale sources (>24h) and emit warning events (AC 2).
- [ ] Write integration tests covering transitions between success → warning → error (AC 1, AC 2).

## Dev Notes
- Align status colors with existing design tokens (check `design-agent.md`).
- Ensure telemetry retention matches requirements from Telemetry epic.

### Testing
- Unit/Integration: `pnpm test --filter ingestion-health`.
- Frontend: add Cypress/Playwright test to assert SSE updates change badge state.

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-03-29 | 0.1 | Drafted for Epic: Client Source Configuration. | PM |

## Dev Agent Record
_Not yet worked._
